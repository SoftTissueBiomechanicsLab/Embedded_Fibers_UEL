function [N, dN] = Hex8ShapeFnc(r,s,t)
    
% Shape functions
N(1) = 1/8*(1-r)*(1-s)*(1-t);
N(2) = 1/8*(1+r)*(1-s)*(1-t);
N(3) = 1/8*(1+r)*(1+s)*(1-t);
N(4) = 1/8*(1-r)*(1+s)*(1-t);
N(5) = 1/8*(1-r)*(1-s)*(1+t);
N(6) = 1/8*(1+r)*(1-s)*(1+t);
N(7) = 1/8*(1+r)*(1+s)*(1+t);
N(8) = 1/8*(1-r)*(1+s)*(1+t);

N = N';

% dN/dzeta
dN(1,1) = -1/8*(1-s)*(1-t);
dN(1,2) = -1/8*(1-r)*(1-t);
dN(1,3) = -1/8*(1-r)*(1-s);

dN(2,1) = 1/8*(1-s)*(1-t);
dN(2,2) = -1/8*(1+r)*(1-t);
dN(2,3) = -1/8*(1+r)*(1-s);

dN(3,1) = 1/8*(1+s)*(1-t);
dN(3,2) = 1/8*(1+r)*(1-t);
dN(3,3) = -1/8*(1+r)*(1+s);

dN(4,1) = -1/8*(1+s)*(1-t);
dN(4,2) = 1/8*(1-r)*(1-t);
dN(4,3) = -1/8*(1-r)*(1+s);

dN(5,1) = -1/8*(1-s)*(1+t);
dN(5,2) = -1/8*(1-r)*(1+t);
dN(5,3) = 1/8*(1-r)*(1-s);

dN(6,1) = 1/8*(1-s)*(1+t);
dN(6,2) = -1/8*(1+r)*(1+t);
dN(6,3) = 1/8*(1+r)*(1-s);

dN(7,1) = 1/8*(1+s)*(1+t);
dN(7,2) = 1/8*(1+r)*(1+t);
dN(7,3) = 1/8*(1+r)*(1+s);

dN(8,1) = -1/8*(1+s)*(1+t);
dN(8,2) = 1/8*(1-r)*(1+t);
dN(8,3) = 1/8*(1-r)*(1+s);

end